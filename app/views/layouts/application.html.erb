<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel="shortcut icon" href="/images/favicon.ico" >
   <link rel="icon" type="image/gif" href="/images/animated_favicon1.gif" >
    <%= render 'layouts/stylesheets' %>
    <%= javascript_include_tag :defaults %>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <%= csrf_meta_tag %>
  <script>
var browserType;

if (document.layers) {browserType = "nn4"}
if (document.all) {browserType = "ie"}
if (window.navigator.userAgent.toLowerCase().match("gecko")) {
 browserType= "gecko"
}

function hide2(id) {
  if (browserType == "gecko" )
     document.poppedLayer =
         eval('document.getElementById((id))');
  else if (browserType == "ie")
     document.poppedLayer =
        eval('document.getElementById(id)');
  else
     document.poppedLayer =
        eval('document.layers[id]');
  document.poppedLayer.style.display = "none";
}

function show2(id) {
  if (browserType == "gecko" )
     document.poppedLayer =
         eval('document.getElementById(id)');
  else if (browserType == "ie")
     document.poppedLayer =
        eval('document.getElementById(id)');
  else
     document.poppedLayer =
         eval('document.layers[id]');
  document.poppedLayer.style.display = "inline";
}

</script>
<script type = "text/javascript">
 function updateDiv() 
 {
    <% puts signed_in? %>
    <% if signed_in? %>
      <% pending_message = Message.find(:all, :conditions => {:deliver_id => current_user.id, :read => false})%>
      <% unless pending_message.nil? %>
          document.getElementById("updateMe").innerHTML = ""
      <% pending_message.each do |message| %>
          document.getElementById("updateMe").innerHTML += "From: <%=message.author_id%><br />Subject:<%= message.subject %><br />Content:<br/><%=message.body %><br />"
                <% message.read = true %>
                <% message.save %>
                <% pending_message.delete message %>
                <% end %>
      <% end %>
    <% end %>
      }var timer = setInterval(updateDiv, 5000);
</script>
  </head>
  <body>
    <div class="container">
      <%= render 'layouts/header' %><br /><br /><br />
      <section class="round">
        <% flash.each do |key, value| %>
          <div class="flash <%= key %>"><%= value %></div>
        <% end %>
        <%= yield %>
      </section>
      <%= render 'layouts/footer' %>
      <%= debug(params) if Rails.env.development? %>
    </div>
  </body>
</html>

